Async builds a state machine around the function
